---
layout: "post"
title: "python-常用高阶函数"
date: "2017-06-15 15:01"
author: "webkong"
categories:
- Python
tags:
- 高阶函数
- 原创
---

> 温故而知新，可以为师矣。

什么是高阶函数， 在数学和计算机的定义里面，高阶函数至少要满足一下一个条件：

* 接受一个或者多个函数作为输入
* 输出一个函数

越是高级的语言，越贴近计算，抽象度越高。这里不得不说函数式编程，函数式编程的一个特点就是，允许把函数本身作为一个参数传递给另一个函数，还允许返回一个函数。像JavaScript等

<!-- more -->

#### map()函数

map()是 Python 内置的高阶函数，它接收一个函数 f 和一个 list，并通过把函数 f 依次作用在 list 的每个元素上，得到一个新的 list 并返回。

```
def f(x):
    return x*x
print map(f, [1, 2, 3, 4, 5, 6, 7, 8, 9])
```
输出结果

```
[1, 4, 9, 10, 25, 36, 49, 64, 81]
```

#### reduce()函数

reduce()函数也是Python内置的一个高阶函数。reduce()函数接收的参数和 map()类似，一个函数 f，一个list，但行为和 map()不同，reduce()传入的函数 f 必须接收两个参数，reduce()对list的每个元素反复调用函数f，并返回最终结果值。
例如，编写一个f函数，接收x和y，返回x和y的和：

```
def f(x, y):
    return x + y
```
调用 reduce(f, [1, 3, 5, 7, 9])时，reduce函数将做如下计算：

```
先计算头两个元素：f(1, 3)，结果为4；
再把结果和第3个元素计算：f(4, 5)，结果为9；
再把结果和第4个元素计算：f(9, 7)，结果为16；
再把结果和第5个元素计算：f(16, 9)，结果为25；
由于没有更多的元素了，计算结束，返回结果25。
```

上述计算实际上是对 list 的所有元素求和。虽然Python内置了求和函数sum()，但是，利用reduce()求和也很简单。
reduce()还可以接收第3个可选参数，作为计算的初始值。如果把初始值设为100，计算：

```
reduce(f, [1, 3, 5, 7, 9], 100)
```
结果将变为125，因为第一轮计算是：
计算初始值和第一个元素：f(100, 1)，结果为101。

#### filter()函数

filter()函数是 Python 内置高阶函数，filter()函数接收一个函数 f 和一个list，这个函数 f 的作用是对每个元素进行判断，返回 True或 False，filter()根据判断结果自动过滤掉不符合条件的元素，返回由符合条件元素组成的新list。
例如，要从一个list [1, 4, 6, 7, 9, 12, 17]中删除偶数，保留奇数，首先，要编写一个判断奇数的函数：

```
def is_odd(x):
    return x % 2 == 1
```

然后，利用filter()过滤掉偶数：

```
filter(is_odd, [1, 4, 6, 7, 9, 12, 17])
```
结果：[1, 7, 9, 17]
利用filter()，可以完成很多有用的功能，例如，删除 None 或者空字符串：

```
def is_not_empty(s):
    return s and len(s.strip()) > 0
filter(is_not_empty, ['test', None, '', 'str', '  ', 'END'])
```

结果：['test', 'str', 'END']
注意: s.strip(rm) 删除 s 字符串中开头、结尾处的 rm 序列的字符。
当rm为空时，默认删除空白符（包括'\n', '\r', '\t', ' ')，如下：

```
a = '     123'
a.strip()
```

结果： '123'

```
a='\t\t123\r\n'
a.strip()
```

结果：'123'

#### 自定义排序函数

Python内置的 sorted()函数可对list进行排序：
```
>>>sorted([36, 5, 12, 9, 21])
[5, 9, 12, 21, 36]
```
但 sorted()也是一个高阶函数，它可以接收一个比较函数来实现自定义排序，比较函数的定义是，传入两个待比较的元素 x, y，如果 x 应该排在 y 的前面，返回 -1，如果 x 应该排在 y 的后面，返回 1。如果 x 和 y 相等，返回 0。
因此，如果我们要实现倒序排序，只需要编写一个reversed_cmp函数：

```
def reversed_cmp(x, y):
    if x > y:
        return -1
    if x < y:
        return 1
    return 0
```

这样，调用 sorted() 并传入 reversed_cmp 就可以实现倒序排序：

```
>>> sorted([36, 5, 12, 9, 21], reversed_cmp)
[36, 21, 12, 9, 5]
```

sorted()也可以对字符串进行排序，字符串默认按照ASCII大小来比较：

```
>>> sorted(['bob', 'about', 'Zoe', 'Credit'])
['Credit', 'Zoe', 'about', 'bob']
```
'Zoe'排在'about'之前是因为'Z'的ASCII码比'a'小。
